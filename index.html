<script>
  async function checkServerStatus() {
    const serverIp = 'left-ky.gl.joinmc.link';

    try {
      const response = await fetch(`https://api.mcstatus.io/v2/status/java/${serverIp}`);
      const data = await response.json();

      const statusDiv = document.getElementById('serverStatus');
      const iconImg = document.getElementById('serverIcon');
      const motdDiv = document.getElementById('motd');
      const softwareDiv = document.getElementById('software');

      if (data && data.online) {
        const online = data.players?.online ?? 0;
        const max = data.players?.max ?? 0;

        statusDiv.textContent = `✅ Server is online — ${online}/${max} players`;
        statusDiv.className = 'status online';

        if (data.icon) {
          iconImg.src = data.icon;
          iconImg.style.display = 'block';
        } else {
          iconImg.style.display = 'none';
        }

        const motdClean = data.motd?.clean?.join(' ');
        motdDiv.textContent = motdClean ? `MOTD: ${motdClean}` : '';
        motdDiv.style.display = motdClean ? 'block' : 'none';

        const softwareName = data.software?.name || 'Unknown';
        const latency = data.latency ? ` • Ping: ${data.latency}ms` : '';
        softwareDiv.textContent = `Running on: ${softwareName}${latency}`;
      } else {
        statusDiv.textContent = '❌ Server is offline';
        statusDiv.className = 'status offline';
        iconImg.style.display = 'none';
        motdDiv.style.display = 'none';
        softwareDiv.textContent = '';
      }
    } catch (error) {
      const statusDiv = document.getElementById('serverStatus');
      statusDiv.textContent = '⚠️ Unable to check server status.';
      statusDiv.className = 'status offline';
      document.getElementById('serverIcon').style.display = 'none';
      document.getElementById('motd').style.display = 'none';
      document.getElementById('software').textContent = '';
    }
  }

  checkServerStatus();
  setInterval(checkServerStatus, 60000);
</script>
